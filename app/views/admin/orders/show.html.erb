<h3>注文履歴詳細</h3>
<table>
  <tr>
    <td><strong>購入者</strong></td>
    <td><%= @order.customer.first_name %>　<%= @order.customer.last_name %></td>
  </tr>
  <tr>
    <td><strong>注文日</strong></td>
    <td><%= @order.created_at.strftime('%Y/%m/%d') %></td>
  </tr>
  <tr>
    <td><strong>配送先</strong></td>
    <td>
     〒<%= @order.postal_code %>　<%= @order.address %> </br>
     <%= @order.name %>
    </td>
  </tr>
  <tr>
    <td><strong>支払方法</strong></td>
    <td><%= @order.method_payment %></td>
  </tr>
  <tr>
    <td><strong>注文ステータス</strong></td>
    <td>
      <%= form_with model: @order, local: true, url: admin_order_path(@order), method: :patch do |f|%>
       <%= f.select :status, Order.statuses_i18n.keys.map{ |k| [I18n.t("enum.order.status.#{k}"), k]} %>
       <%= f.submit "更新" %>
      <% end %>
    </td>
  </tr>
</table>


<table>
  <tr>
    <td>商品名</td>
    <td>単価（税込）</td>
    <td>数量</td>
    <td>小計</td>
    <td>製作ステータス</td>
  </tr>
  <% @order_items.each do |order_item| %>
  <tr>
    <td>
      <%= order_item.item.name %>
    </td>
    <td>
      <%= (order_item.price * @tax).round(0) %>
    </td>
    <td>
      <%= order_item.amount %>
    </td>
    <td>
      <%= (order_item.price * order_item.amount * @tax).round(0) %>
    </td>
    <td>
       <%= form_with model: order_item, local: true, url: admin_order_item_path(order_item), method: :patch do |f|%>
       <%= f.select :making_status, OrderItem.making_statuses.keys.map{ |k| [I18n.t("enum.order_item.making_status.#{k}"), k]} %>
       <%= f.submit "更新" %>
      <% end %>
    </td>
  </tr>
  <% end %>
</table>

<table>
  <tr>
    <td>商品合計</td>
    <td><%= @total_order_price %>円</td>
  </tr>
  <tr>
    <td>送料</td>
    <td><%= @shipping %>円</td>
  </tr>
  <tr>
    <td>請求金額合計</td>
    <td><%= @total_payment %>円</td>
  </tr>
</table>

